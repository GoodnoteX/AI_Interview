
> 大家好，这里是好评笔记，公主号：Goodnote，专栏文章私信限时Free。本笔记介绍机器学习中常见的损失函数和代价函数，各函数的使用场景。
> 


![在这里插入图片描述](https://github.com/GoodnoteX/Ai_Interview/blob/main/机器学习笔记/image/1.jpg)



> @[toc]
# 损失函数
## 一、回归问题中的损失函数
### 1. 均方误差（Mean Squared Error, MSE）

**定义**：

$$
\text{MSE} = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
$$

- **描述**：MSE 衡量的是预测值和真实值之间的**平方误差的平均值**。对较大的误差会进行更大的惩罚，因此它对异常值（outliers）非常敏感。
- **应用场景**：线性回归、岭回归等模型的损失函数。
- **优点**：简单易于理解，容易求导和计算。
- **缺点**：**对异常值敏感**，可能导致模型被少数异常样本主导。

### 2. 平均绝对误差（Mean Absolute Error, MAE）
**定义**：

$$
\text{MAE} = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i|
$$

- **描述**：MAE 衡量的是预测值和真实值之间的**绝对误差的平均值**。它对每个误差的惩罚是线性的，因此对异常值的惩罚不如 MSE 严重。
- **应用场景**：在对异常值不敏感的回归任务中使用。
- **优点**：**对异常值不敏感**，能够更加稳定地反映模型性能。
- **缺点**：在优化过程中，**绝对值函数不可导**，求解困难。

### 3. 对数余弦损失（Log-Cosh Loss）

**定义**：

$$
\text{Log-Cosh Loss} = \frac{1}{n} \sum_{i=1}^{n} \log\left(\cosh\left(y_i - \hat{y}_i\right)\right)
$$

>    说明cosh(x) : 双曲余弦函数，公式为 $\cosh(x) = \frac{e^x + e^{-x}}{2}$。

- **描述**：对数余弦损失是**Huber 损失的变体**，它的行为类似于 MAE，同时对大误差有更小的增长率。
- **应用场景**：适用于异常值影响较大的回归任务。
- **优点**：具有**平滑性，易于求导**，**对小误差敏感**而**对大误差鲁棒**。
- **缺点**：相比其他损失函数计算复杂度较高。
### 4. Huber 损失（Huber Loss）
**定义**：

$$
L(y_i, \hat{y}_i) = 
\begin{cases} 
\frac{1}{2} (y_i - \hat{y}_i)^2 & \text{if } |y_i - \hat{y}_i| \leq \delta, \\
\delta \cdot |y_i - \hat{y}_i| - \frac{1}{2} \delta^2 & \text{if } |y_i - \hat{y}_i| > \delta.
\end{cases}
$$
> - $\delta$: 超参数，定义切换 MSE 和 MAE 的阈值。
> - $|y_i - \hat{y}_i|$: 误差的绝对值。



- **描述**：Huber 损失是**MSE 和 MAE 的折中**。对于**小误差，使用 MSE**；对于**大误差，使用 MAE**，从而对异常值有一定的鲁棒性。
- **应用场景**：回归问题中存在异常值，但又不希望过于忽略异常值的场景。
- **优点**：**对小误差敏感**，同时**对大误差具有一定的抗干扰性**。
- **缺点**：参数 \($\delta$\) 需要手动调节，不同数据集效果不同。

### 5. 平均平方对数误差（Mean Squared Logarithmic Error, MSLE）
**定义**：

$$
\text{MSLE} = \frac{1}{n} \sum_{i=1}^{n} \left( \log(1 + y_i) - \log(1 + \hat{y}_i) \right)^2
$$


> - $n$: 数据点的总数。
> - $y_i$: 第 $i$ 个真实值（必须为非负数）。
> - $\hat{y}_i$: 第 $i$ 个预测值（必须为非负数）。
> - $\log(1 + x)$: 对 $x$ 加 1 后取自然对数，用于平滑较小的值和避免对 0 的对数操作。


- **描述**：MSLE 用于处理**目标值差异较大**且**有显著指数增长趋势**的情况。它**更关注相对误差**，而非绝对误差。
- **应用场景**：如人口增长预测、市场销量预测等场景。
- **优点**：对**大数值的预测更稳定**，对目标值的比例关系有更好的衡量。
- **缺点**：当目标值非常小时，惩罚效果不明显。
### 总结

| **损失函数**                    | **描述**                                                                                                                                      | **应用场景**                               | **优点**                                                                 | **缺点**                                                      |
|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|----------------------------------------------------------------------|---------------------------------------------------------------|
| **均方误差 (MSE)**               | 衡量预测值和真实值之间**平方误差的平均值**，对较大误差进行更大惩罚。                                                                                | 线性回归、岭回归等                         | 简单易于理解，容易求导。                                                | **对异常值敏感**。                                                |
| **平均绝对误差 (MAE)**           | 衡量预测值和真实值之间**绝对误差的平均值**。                                                                                      | 对异常值不敏感的回归任务                   | **对异常值不敏感**，反映模型性能更稳定。                                      | 优化困难，**绝对值函数不可导**。                                    |
| **对数余弦损失 (Log-Cosh)**      | Huber 损失的变体，既**能捕捉小误差，也对大误差有更小的增长率**。                                                                                   | 异常值影响较大的回归任务                   | 平滑性好，**易于求导**，适应大误差和小误差。                                  | 计算复杂度高。                                                |
| **Huber 损失 (Huber Loss)**      | **结合MSE和MAE**，小误差时使用 MSE，大误差时使用 MAE，平衡异常值的影响。                                                                                        | 存在异常值但不希望完全忽略的场景            | 对小误差敏感，对大误差有抗干扰性。                                        | 需调节参数 \(delta\)。                                      |
| **平均平方对数误差 (MSLE)**      | 衡量目标值差异大且有**指数增长**趋势的情况，**关注相对误差**而非绝对误差。                                                                            | 人口增长预测、市场销量预测等               | 对大数值预测更稳定，**适应有比例关系的数据**。                                  | 对极小值目标效果不佳。                                        |

## 二、分类问题中的损失函数
### 1. 0-1 损失（0-1 Loss）
**定义**：

$$
L_(y, \hat{y}) =
\begin{cases}
0, & \text{if } y = \hat{y}, \\
1, & \text{if } y \neq \hat{y}.
\end{cases}
$$

> 详细全文请移步公主号：Goodnote。  
参考：[欢迎来到好评笔记（Goodnote）！](https://mp.weixin.qq.com/s/lCcceUHTrM7wOjnxkfrFsQ)

