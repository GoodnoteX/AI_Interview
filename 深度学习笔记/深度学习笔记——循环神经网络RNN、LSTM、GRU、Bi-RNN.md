> 大家好，这里是好评笔记，公主号：Goodnote，专栏文章私信限时Free。本文详细介绍面试过程中可能遇到的循环神经网络RNN、LSTM、GRU、Bi-RNN知识点。
> 
![在这里插入图片描述](https://github.com/GoodnoteX/Ai_Interview/blob/main/深度学习笔记/image/6.png)


---
> @[toc]
> 大家好，这里是Goodnote(好评笔记)。本文详细介绍面试过程中可能遇到的循环神经网络RNN、LSTM、GRU、Bi-RNN知识点。
> 


# 文本特征提取的方法
## 1. 基础方法
### 1.1 词袋模型（Bag of Words, BOW）
**词袋模型**最简单的方法。它将文本表示为一个**词频向量**，**不考虑词语的顺序或上下文关系**，只统计每个词在文本中出现的频率。
#### 工作原理
1. **构建词汇表**：对整个语料库中的所有词汇建立一个词汇表（也称为词典）。每个文档中的每个词都与词汇表中的一个位置对应。
2. **生成词频向量**：对于每个文本（文档），生成一个**与词汇表长度相同的向量**。向量中每个元素表示该词在文档中出现的次数（或者是否出现，用二进制表示）。
#### 举例
假设有两个句子：
- 句子 1：`猫 喜欢 鱼`
- 句子 2：`狗 不 喜欢 鱼`

词汇表 = ["猫", "狗", "喜欢", "不", "鱼"]

- 句子 1 的词袋向量表示为：[1, 0, 1, 0, 1]
- 句子 2 的词袋向量表示为：[0, 1, 1, 1, 1]
#### 优点
- 简单直观，易于实现，有效地表示词频信息。
#### 缺点
- **忽略词序**：词袋模型无法捕捉词语的顺序，因此在语义表达上有局限。
- **高维稀疏**：对于大词汇表，词袋模型会生成非常长的特征向量，大多数元素为 0，容易导致**稀疏矩阵，影响计算效率**。
- **受到常见词的影响**：常见词（如 "the"、"and" 等）可能在各类文档中频繁出现，但对语义贡献较少，词袋模型会受到这些高频词的影响，降低模型的效果。

### 1.2 TF-IDF（Term Frequency-Inverse Document Frequency）
**TF-IDF** 是对词袋模型的改进，它**为词语赋予不同的权重**，来**衡量每个词在文档中的重要性**。与词袋模型相比，TF-IDF 不仅考虑词频，还考虑词的普遍性，**以避免常见词（如"the"、"and"）的影响**。
#### 工作原理


1. **TF（词频）**：计算某个词在文档中出现的频率。
  $$TF(t,d)=\frac{词t在文档d中的出现次数}{文档d的总词数}$$
2. **IDF（逆文档频率）**：衡量词在整个语料库中的普遍性，出现频率越低的词权重越高。
    $$IDF(t)=\log\left(\frac{N}{1 + DF(t)}\right)$$
     - 其中$N$是文档总数，$DF(t)$是包含词$t$的文档数。
3. **TF - IDF**：将$TF$和$IDF$相乘，得到词在特定文档中的权重：
  $$TF - IDF(t,d)=TF(t,d)\times IDF(t)$$



#### 举例
对于句子“猫 喜欢 鱼”和“狗 不 喜欢 鱼”，假设 "喜欢" 出现在所有文档中，IDF 会给它较低的权重，而像 "猫"、"狗" 这样的词会有较高的 IDF 权重，因为它们只出现在一部分文档中。
#### 优点
- **更准确地反映词的重要性，避免了词袋模型中常见词占主导地位的情况**。尤其适用于文本分类任务。
#### 缺点
- **稀疏矩阵**：虽然词频的权重经过调整，但**词汇表的大小仍然很大，容易产生稀疏矩阵问题**。
- **忽略词序**：仍然**无法捕捉词语之间的顺序和上下文关系**。
### 1.3 TF-IDF的改进——BM25
BM25**对TF和IDF进行加权**，同时考虑文档长度对相关性的影响，使得**对较短和较长文档的评分更加合理**。

BM25 的计算公式如下：


$$BM25(q,d)=\sum_{t\in q}IDF(t)\cdot\frac{TF(t,d)\cdot(k_1 + 1)}{TF(t,d)+k_1\cdot(1 - b + b\cdot\frac{|d|}{avgdl})}$$
其中：
- $q$ 是查询，$d$ 是文档，$t$ 是查询中的词。
- $IDF$是与$TF - IDF$相似的逆文档频率。
- $TF$是词频。
- $k_1$ 是调节词频饱和度的参数，通常取值范围为$[1.2,2.0]$。
- $b$ 是调节文档长度的参数，通常取值范围为$[0.0,1.0]$，$b = 0.75$是一个常用的设置。
- $|d|$是文档的长度（词数），$avgdl$是语料库中文档的平均长度。





> 详细全文请移步公主号：Goodnote。  
参考：[欢迎来到好评笔记（Goodnote）！](https://mp.weixin.qq.com/s/lCcceUHTrM7wOjnxkfrFsQ)


